@page "/"

<PageTitle>Index</PageTitle>

<h1>Hello, world!</h1>
<div class="chart-container">
<EBar Option="option" Style="width: 100%; height: 720px; margin-top: 20px; margin-right: 20px;" EventTypes="eventTypes"></EBar>

@if (callbackArgs != null)
{
    <div>
        <p>EventType : @callbackArgs.EventType</p>
        <p>@((MarkupString)callbackArgs.ToString().Replace(";", ";<br/>"))</p>
    </div>
}
</div>

@code {
    private EChartsOption<Blazor.ECharts.Options.Series.Bar.Bar>? option;

    private EchartsEventArgs? callbackArgs;

    private List<EventType> eventTypes = new List<EventType> { EventType.click, EventType.brush, EventType.brushselected };

    protected override async Task OnInitializedAsync()
    {
        await Task.Delay(100);

        option = new()
            {
                Color = new[] { "#8EC9EB" },
                Legend = new() { Data = "고도(km)와 기온(°C)의 관계" },
                Tooltip = new()
                {
                    Trigger = TooltipTrigger.Axis,
                    Formatter = "Temperature : <br/>{b}km : {c}°C"
                },
                Grid = new()
                {
                    new() { Left = "3%", Right = "4%", Bottom = "3%", ContainLabel = true }
                },
                XAxis = new()
                {
                    new() { Type = AxisType.Value, SplitLine = new SplitLine() { Show = false }, AxisLabel = new AxisLabel() { Formatter = "{value} °C" } }
                },
                YAxis = new()
                {
                    new() { Type = AxisType.Category, AxisLine = new AxisLine() { OnZero = false }, AxisLabel = new AxisLabel() { Formatter = "{value} km" }, BoundaryGap = true, Data = new[] { "0", "10", "20", "30", "40", "50", "60", "70", "80" } }
                },
                Series = new()
                {
                    new Blazor.ECharts.Options.Series.Bar.Bar()
                    {
                        Name = "고도(km)와 온도(°C) 변화의 관계",
                        Smooth = true,
                        BarCategoryGap = 25,
                        LineStyle = new { normal = new { width = 3, shadowColor = "rgba(0,0,0,0.4)", shadowBlur = 10, shadowOffsetY = 10 } },
                        Data = new[] { 15, -50, -56.5, -46.5, -22.1, -2.5, -27.7, -55.7, -76.5 }
                    }
                },
                Graphic = new()
                {
                    new GraphicImage()
                    {
                        Id = "logo",
                        Right = 20,
                        Top = 20,
                        Z = -10,
                        Bounding = "raw",
                        Style = new()
                        {
                            Image = "http://echarts.baidu.com/images/favicon.png",
                            Width = 150,
                            Height = 150,
                            Opacity = 0.4
                        }
                    },
                    new GraphicGroup()
                    {
                        Rotation = Math.PI / 4,
                        Bounding = "raw",
                        Right = 110,
                        Bottom = 110,
                        Z = 100,
                        Children = new()
                        {
                            new
                            {
                                type = "rect",
                                left = "center",
                                top = "center",
                                z = 100,
                                shape = new
                                {
                                    width = 400,
                                    height = 50
                                },
                                style = new
                                {
                                    fill = "rgba(0,0,0,0.3)"
                                }
                            },
                            new
                            {
                                type = "text",
                                left = "center",
                                top = "center",
                                z = 100,
                                style = new
                                {
                                    fill = "#fff",
                                    text = "ECHARTS BAR CHART",
                                    font = "bold 26px Microsoft YaHei"
                                }
                            }
                        }
                    },
                    new GraphicGroup()
                    {
                        Left = "10%",
                        Top = "center",
                        Children = new()
                        {
                            new
                            {
                                type = "rect",
                                z = 100,
                                left = "center",
                                top = "middle",
                                shape = new
                                {
                                    width = 190,
                                    height = 90
                                },
                                style = new
                                {
                                    fill = "#fff",
                                    stroke = "#555",
                                    lineWidth = 2,
                                    shadowBlur = 8,
                                    shadowOffsetX = 3,
                                    shadowOffsetY = 3,
                                    shadowColor = "rgba(0,0,0,0.3)"
                                }
                            },
                            new
                            {
                                type = "text",
                                z = 100,
                                left = "center",
                                top = "middle",
                                style = new
                                {
                                    fill = "#333",
                                    text = string.Join("\n", new[]{
                                    "가로축은 온도(°C)를 나타냅니다.",
                                    "세로축은 높이를 나타내며, 단위는 km입니다",
                                    "오른쪽 상단에 그림으로 만들어진 워터마크가 있습니다",
                                    "이 텍스트 블록은 각 다이어그램에 배치될 수 있습니다.",
                                    "위치의 종류"
                                }),
                                    font = "14px Microsoft YaHei"
                                }
                            }
                        }
                    }
                },
                Brush = new()
                {
                    XAxisIndex = "all",
                    ThrottleType = "debounce",
                    ThrottleDelay = 600
                }
            };

        await base.OnInitializedAsync();
    }

    private void OnEchartsEvent(EchartsEventArgs args)
    {
        callbackArgs = args;
    }
}